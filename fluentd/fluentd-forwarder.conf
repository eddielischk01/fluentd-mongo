<source>
  @type tail
  path /var/log/test/*.log #...or where you placed your Apache access log
  pos_file /var/log/test/sample.log.pos # This is where you record file position
  tag fluentdbit.json #fluentd tag!
  format json # one JSON per line
  time_key time
  time_format %Y-%m-%dT%H:%M:%S.%L%Z
  refresh_interval 1s
</source>

<match fluentdbit.**>
  @type copy
  <store>
    @type forward
    require_ack_response true
    # primary host
    <server>
      host fluentd-aggregator-a
      port 24224
    </server>
    # use secondary host
    <server>
      host fluentd-aggregator-b
      port 24224
      standby
    </server>

    # use longer flush_interval to reduce CPU usage.
    # note that this is a trade-off against latency.
    <buffer>
      flush_interval 1s
    </buffer>
 
  </store>
  <store>
    @type stdout
  </store>
 
</match>
